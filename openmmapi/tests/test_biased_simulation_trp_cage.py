
# no biased potential

import datetime, os
from simtk.openmm.app import *
from simtk.openmm import *
from simtk.unit import *
from sys import stdout

from ANN import *

############################ PARAMETERS BEGIN ###############################################################

record_interval = int(sys.argv[1])
total_number_of_steps = int(sys.argv[2])

temperature = int(sys.argv[3])   # in Kelvin

folder_to_store_output_files = './dependency/' + sys.argv[4] # this is used to separate outputs for different networks into different folders
energy_expression_file = './dependency/' + sys.argv[5]

force_constant = sys.argv[6]

# xi_1_0 = sys.argv[7]
# xi_2_0 = sys.argv[8]


if not os.path.exists(folder_to_store_output_files):
    try:
        os.makedirs(folder_to_store_output_files)
    except:
        pass
        

assert(os.path.exists(folder_to_store_output_files))

input_pdb_file_of_molecule = './dependency/1l2y.pdb'
force_field_file = 'amber03.xml'
water_field_file = 'tip4pew.xml'

if force_constant == '0':   # unbiased case
    pdb_reporter_file = '%s/unbiased_%dK_output.pdb' % (folder_to_store_output_files, temperature)  # typically the folder for unbiased case is ../target/unbiased/
    state_data_reporter_file = '%s/unbiased_%dK_report.txt' % (folder_to_store_output_files, temperature)
else:
    pdb_reporter_file = '%s/biased_%dK_fc_%s_output.pdb' % (folder_to_store_output_files, temperature, force_constant)
    state_data_reporter_file = '%s/biased_%dK_fc_%s_report.txt' % (folder_to_store_output_files, temperature, force_constant)

if os.path.isfile(pdb_reporter_file):
    os.rename(pdb_reporter_file, pdb_reporter_file.split('.pdb')[0] + "_bak_" + datetime.datetime.now().strftime("%Y_%m_%d_%H_%M_%S") + ".pdb") # ensure the file extension stays the same

if os.path.isfile(state_data_reporter_file):
    os.rename(state_data_reporter_file, state_data_reporter_file.split('.txt')[0] + "_bak_" + datetime.datetime.now().strftime("%Y_%m_%d_%H_%M_%S") + ".txt")

k1 = force_constant
k2 = force_constant


flag_random_seed = 0 # whether we need to fix this random seed

box_size = 4.5    # in nm
neg_ion = "Cl-"

time_step = 0.002        # simulation time step, in ps



############################ PARAMETERS END ###############################################################


pdb = PDBFile(input_pdb_file_of_molecule)
modeller = Modeller(pdb.topology, pdb.positions)

forcefield = ForceField(force_field_file, water_field_file)
modeller.addSolvent(forcefield, boxSize=Vec3(box_size, box_size, box_size)*nanometers, negativeIon = neg_ion)   # By default, addSolvent() creates TIP3P water molecules
modeller.addExtraParticles(forcefield)    # no idea what it is doing, but it works?

platform = Platform.getPlatformByName('Reference')
platform.loadPluginsFromDirectory('.')  # load the plugin from the current directory

system = forcefield.createSystem(modeller.topology,  nonbondedMethod=Ewald, nonbondedCutoff = 1.0*nanometers, \
                                 constraints=AllBonds, ewaldErrorTolerance=0.0005)

system.addForce(AndersenThermostat(temperature*kelvin, 1/picosecond))
system.addForce(MonteCarloBarostat(1*atmospheres, temperature*kelvin, 25))

# add custom force (only for biased simulation)
if force_constant != '0':
    force = ANN_Force()

    force.set_layer_types(['Tanh', 'Tanh'])
    index_of_backbone_atoms = [1, 2, 3, 17, 18, 19, 36, 37, 38, 57, 58, 59, 76, 77, 78, 93, 94, 95, \
        117, 118, 119, 136, 137, 138, 158, 159, 160, 170, 171, 172, 177, 178, 179, 184, \
        185, 186, 198, 199, 200, 209, 210, 211, 220, 221, 222, 227, 228, 229, 251, 252, \
        253, 265, 266, 267, 279, 280, 281, 293, 294, 295]

    force.set_list_of_index_of_atoms_forming_dihedrals_from_index_of_backbone_atoms(index_of_backbone_atoms)
    force.set_num_of_nodes([76, 10, 2])
    force.set_potential_center(
        [0.8, 0]
        )
    force.set_force_constant(float(force_constant))
    
    force.set_coeffients_of_connections([
                                        [-0.052177503528237718, 0.16597625857766973, -0.032798222387664784, -0.051978712690076381, 0.0057709588667189671, 0.0025166008516035289, 0.011423609817562626, 0.008397239890143033, 0.0091601638386910062, 0.018162284723476828, 0.015921233324827751, 0.010606608136899169, 0.019511800423947085, 0.038987239417827238, -0.0034435744115909992, 0.015783595623298809, -0.19697272865063675, 0.026853313730105573, -0.015917612781868675, 0.027948509415733656, -0.01123070847783318, 0.061363109839442063, -0.0098282552007999506, -0.0046883347688601489, -0.01624292286122362, -0.044489049603146903, 0.0087380289198054975, 0.0064461943782087704, -0.097648067136175853, -0.066626765641010721, 0.022232586046277068, 0.030191768508190282, -0.00049608550121754062, 0.0033385018305775193, -0.021330347117359261, -0.020173277888722214, 0.048466647754159896, 0.013107813281489793, 0.0051165799180866861, -0.00018118880063614111, -0.0022402576800279648, -0.011331014047322964, 0.0047835596471919777, -0.006807491431001688, -0.027584075726363112, -0.013300444754416507, -0.017938550513748298, -0.017494582974747316, 0.020056464563130053, -0.0060577950593870391, 0.00014359399421715025, 0.0027562980379205898, -0.026985122024829378, 0.0010065889614161833, 0.089970581596256274, -0.17318623669898145, -0.05730924859298675, -0.023549892029571612, -0.0061847297043686215, -0.0039422823298815041, -0.037681879653549785, -0.001213074014368728, -0.040900385803630902, -0.0070472102036951536, -0.036762316198791764, -0.11872110421452677, 0.033648646663914289, -0.026646617022392401, 0.016306814653938462, 0.0022674369277169647, 0.0064932986819269557, -0.011047092534923886, 0.010725886549379062, 0.0049672329033000834, -0.0060841736152562852, 0.0034615100954646133, -0.016283046415041927, -0.00025491946322724816, 0.019806390603575842, -0.012648133094641833, 0.015015166607865634, -0.01737122329812274, 0.024013283090819723, -0.0083446392113536716, 0.021414930921040593, -0.013008028721081597, 0.018129864469590428, -0.0013817447748398545, 0.01442871700727869, -0.0052955607080397166, 0.020557709770599203, -0.0079292744649227739, -0.0031628509694779914, 0.0075518916906911803, 0.061322600886745605, -0.019226114968931771, -0.024846930440316981, -0.024606348637313556, 0.020640504517135356, -0.010026272034041677, 0.02568865166217572, -0.014514573542481526, 0.017068845073787697, -0.010152012934610544, 0.015328197214359083, 0.01245379853510737, -0.013363249559870385, 0.018581393309223829, -0.017358461410139497, 0.013186487350531103, -0.026718918464765429, 0.0082275253407868357, -0.036453110508504985, 0.02208841644883278, 0.0014916133104908452, -0.021378162277567812, 0.0014857429471075892, -0.027172279508385241, 0.012289019345839312, -0.017334169831264575, 0.013470521464775502, -0.012446310993830192, 0.010063993096089479, -0.022115650191734441, 0.0058176179679667499, -0.024620765999154838, 0.015009866017232426, -0.020327297110745567, 0.0097421138316000355, -0.032856390730253059, -0.010116251658914244, 0.0063551648802713089, 0.031393064844465454, 0.055235697152933534, 0.0057208051559520289, -0.023286276324231914, 0.011932011533966242, -0.017146340461776991, 0.0014325247068172973, -0.02604181339832852, -0.0027201794547402412, 0.041592704094778256, -0.013583797011698597, -0.01151672757755387, 0.0038940626486957579, -0.022569568355556766, 0.01040015470355034, -0.022154320214268733, 0.0034374736010765387, -0.026517734869184923, -0.028649728495741843, -0.010696275424954561, -0.019862644338241742, 0.02665378314866941, 0.019801254063197545, -0.024383565160656057, 0.017384174788953714, -0.017378197615180398, 0.024265868477474511, -0.0099767960458407769, 0.021336668104996903, -0.0082879255355056049, 0.024602291519722451, -0.002896168162602286, 0.021156079862494844, -0.0050911008279466092, 0.024386204833905117, -0.0099255283670406109, -0.01092718008801386, 0.004514132339700082, 0.039309074068733921, -0.024073698912638979, -0.019730569403431129, -0.02238770483826041, 0.031427711936982648, -0.0095660448528567792, 0.015463400759537102, -0.012943629136425367, 0.025078165736334299, -0.010182478848519258, 0.016130513078847917, -0.0064485875229756892, -0.01996462433404354, 0.022923979439844953, -0.013009194273204752, 0.0064775859685452875, -0.024072143915688939, 0.010036898526756407, -0.024661812852436901, 0.025318957530325009, 0.0036784506475940372, -0.019510551818085961, 0.0046007545495479881, -0.031177867969137754, 0.0082553011618861239, -0.021462159898522747, 0.010077549351308257, -0.028894493766034268, 0.0076689262990404794, -0.016097210429581843, 0.012612221865310073, -0.017724566201636788, 0.0010099481242158205, -0.0063717131440998104, 0.0088298644357954845, -0.020032745702547552, 0.00031617991560107438, -0.018729246058538131, 0.015576159594079217, 0.054446409361957673, 0.018902103453380649, -0.027121703142361158, 0.018604209681295281, -0.010215062906292453, -0.0034313251034506949, -0.023150810982494319, -0.01419331347580945, 0.013208841015006186, -0.005707725882411808, -0.026973172877421042, 0.014638020359594146, -0.023466923608514476, 0.011849663513951118, -0.021036700690030937, 0.0024534176668701475, -0.024447194678310708, -0.011215067076641492, -0.013495683637156461, -0.01951867159784447, -0.009816176871453957, 0.019418500739139942, -0.0092687845813334661, 0.016235445078831581, -0.0061113748554237944, 0.009677557148319518, -0.0064617639751907378, 0.013557348334258196, -0.020028838557610392, 0.024110923540634956, 0.00021486774523187343, 0.017129688325066002, -0.010876488223486438, 0.023250605510765538, -0.0076984943597473328, 0.015661706038230843, 0.008452209746919884, 0.042094112747079929, -0.025812334624096066, -0.02509290003748427, -0.032740914945322545, 0.028289598198251095, -0.010385105226801741, 0.027133790673134765, -0.0057843938006240997, 0.019421166760019384, -0.0081061911089954017, 0.03055966183721065, 0.018266418413887049, -0.013449784753333575, 0.011514305121745458, -0.016164586870753166, 0.0052221055975052782, -0.017874018065022073, 0.016620747792940184, -0.045094410214893778, 0.022995438013193058, 0.014466480737982767, -0.020122380885792334, 0.016849853259714352, -0.017606151955364833, 0.013416389546288937, -0.017079534595373785, 0.0080432373661233104, -0.014327166664817138, 0.0031454162771484238, -0.019840774281092214, 0.0038246567333318957, -0.023862665954417439, 0.0056909248887935873, -0.021594248347675517, 0.0095175637519187232, -0.019107005535134815, -0.013801577416898622, 0.012863648433376958, 0.035839263536956691, 0.060375933022871871, 0.016902348350219334, -0.018975788860592844, 0.018951654104826767, -0.01871298368128118, -0.012761241234871115, -0.021813145611314883, -0.0037462591535775487, 0.039136812188071718, 0.00013567378836129999, -0.018351298415641225, 0.0033106501473575433, -0.022204512743209358, 0.014562023339635315, -0.031708656382729399, -0.0033279519015626947, -0.021078138516590586, -0.018093483890999386, -0.009267945395682535, 0.050482441612564329, -0.16510450690065975, 0.023747225439585358, 0.036001013234304567, -0.0078324928732492367, 0.0050883204001440138, -0.00015382503820574283, -0.0083395695462773287, -0.016853093957670876, -0.014067272938825544, -0.012590226719452657, -0.011354579877072248, -0.018107590626765036, -0.021584122453657699, -0.014670772868193549, -0.018731896842609522, 0.18377690825964205, -0.038276962022722537, -0.0012253900999891706, -0.036127683496622008, 0.014388135238422401, -0.064370522483081047, -0.0024796573299911088, 0.0070534001370651106, 0.00782060680013715, 0.039661836011427115, -0.0046425898811810569, 0.0046383143246418353, 0.082809018729166475, 0.066087587150779142, -0.021842552379206667, -0.022698952504163161, -0.0023760445849993271, -0.0086181271585935339, 0.027612798708777839, 0.019542440831823927, -0.041982961972743746, -0.0026173603540185402, -0.015766477718904909, 0.00097972950155057357, 0.0092596694270056009, -0.00468806927487634, -0.0027164603911960599, 0.0076189429557656126, 0.033140715321140886, 0.011264607044432311, 0.02052033498002782, 0.0095516942227161089, -0.0022653930144701587, 0.0016677518906649264, 0.0039594318422262222, -0.0033651237890739861, 0.0074171169354201542, -0.0064712112800350855, -0.083503230397811185, 0.15938974122611355, 0.05106406815442794, 0.023241422520591967, 0.0075005376438284886, 0.0082851070166921111, 0.031868608285816044, -0.0016595156652705575, 0.028445278929208295, -0.0050735847229742012, 0.042880183444418303, 0.11913218288024473, -0.038014064143009528, 0.031384874369266118, -0.012040889599234886, -0.0068608159701088944, -0.0035813601103630841, 0.012758887419409417, -0.010383249869333378, 3.9153662491087511e-05, 0.0038923073271331121, 0.0014730580060017078, 0.025145715058674224, -0.0041308130570075208, -0.017436598193433225, 0.0051637363452543602, -0.014534520982744461, 0.022146834802520925, -0.0019171122031597855, 0.0049674370064713824, -0.024480296797376358, 0.0024766051591929212, -0.015210386580315425, 0.0084707411684814063, -0.019570863057031575, 0.0010631185199445415, -0.025990701783563223, 0.0069332648100277183, -0.0032213682970513814, -0.012556767390271938, -0.050622012070653859, 0.022849685877367534, 0.028114028053621051, 0.028574373946299907, -0.023583293370150627, 0.0079009980171937041, -0.014796333479555401, 0.0050635539911177384, -0.032142670696905129, 0.007050917455505591, -0.022008306659987355, -0.008113853915981524, 0.012849832241188892, -0.014923939033775344, 0.023587660957132155, -0.008439477295304856, 0.019628661878368234, -0.01495067130297449, 0.035740099547783906, -0.028134578910524018, -0.010258549176840404, 0.02429724273732476, -0.0023935844131704269, 0.022366496720619414, -0.011211985989838698, 0.027439775070591772, -0.0034415255279654391, 0.024484141747354235, -0.013438676981031517, 0.030191177035917716, -0.0062810094879021542, 0.014839113586042766, -0.0074414537601212045, 0.02355577967602664, -0.0062903645765786578, 0.024888010939836658, 0.0076553156749913807, 0.010620145475491803, -0.031950792852870544, -0.062237225443985481, -0.017270542397124736, 0.019409443129061021, -0.020249544682577572, 0.029181448389900423, 0.0012043548119843824, 0.029943927684260314, 0.0075331412557442324, -0.039856127903697594, 0.0077294659543133302, 0.026172641753102303, 0.0011965685061225795, 0.014152206183991696, -0.0076551537052950234, 0.023760645559770931, -0.0046022338466699935, 0.019937768646357872, 0.020562136307400978, -0.011448292574063391, 0.013172806919968059, -0.015857469258496681, -0.012523084127542747, 0.013508527611786926, -0.02561436543020575, 0.0066299075528610555, -0.02895305002596801, 0.010617050774934023, -0.010037324277935538, 0.0095475233384035088, -0.021053394442435262, 0.010274774515706063, -0.021983365301078361, 0.0052229852706004746, -0.021500457626629509, 0.0029258804809770603, 0.014485894931530584, -0.0039062687494880698, -0.040438666093222324, 0.016536479820719666, 0.01628068343416136, 0.023131378521373598, -0.020789121689315772, 0.01689318910784289, -0.016705506967808863, 0.0071180297275173126, -0.031503796567968589, 0.015015248365631315, -0.019607158365444678, -0.0057584697010138741, 0.011265529607417397, -0.032378325710859579, 0.031191959015247673, -0.0065419278579613108, 0.028512873940211552, -0.016719628689339489, 0.024564989248193943, -0.019135623616768075, -0.0053166736154069321, 0.018459860742262062, -0.01154021411325884, 0.029058730696092397, -0.010872700805667252, 0.021364033177180681, -0.0075254288869899674, 0.013089521136939676, -0.0067052730297076949, 0.026046622523855058, -0.0080534854869837077, 0.022855995258692065, -0.0069808351679787163, 0.032679830412313857, -0.00076845332446922622, 0.019608469551682779, -0.0036664259560750235, 0.0097497303141755795, -0.022140487226174333, -0.050708499273780662, -0.023012640082257091, 0.026942451605350571, -0.0097208207348814177, 0.019687949915562494, 0.0030667422000671819, 0.027250589377004579, 0.017232524405072013, -0.017485108988841501, 0.010343277105980082, 0.015743206941740907, -0.0062629011501458848, 0.025524248792779942, -0.0085861062581066502, 0.017096917658610485, 0.0013886042737306934, 0.027626561683450079, 0.016761315352260567, 0.010124584863804511, -0.048129978489403764, 0.16026721425641141, -0.025054161878460025, -0.040686194653222797, -0.0092095818838389305, -0.01757340855590684, 0.012266813912804122, 0.0080715124322913896, 0.010423868855450689, 0.006777148152942716, 0.023013387492085823, 0.010190949055598694, 0.026873788887974665, 0.025299491285354712, 0.0154323932247036, 0.013963677745695338, -0.17151496359377716, 0.025272839681364928, -0.032044872307974502, 0.035959763014765604, -0.0048346953138634187, 0.067783203903418257, -0.0042937754157104432, -0.0056680027429851084, -0.017829230343249354, -0.038169825596043296, 0.002741227699650281, 0.0049790091152560586, -0.099314319930009234, -0.07011591556760384, 0.0162768360402329, 0.028267145394709679, 0.0043489981566890955, -0.0024127076159275833, -0.01395362111945673, -0.0074914224077326161, 0.046917945458981009, 0.0063742099922106527, 0.0031111162488415291, 2.3695302608715236e-05, -0.00019151450609729086, -0.0032639011554523971, 0.0056234619873808955, 0.00096333361831425237, -0.013236298870979551, -0.0011260585776790529, -0.01869517728013613, -0.0060703908453866558, 0.013613306035118641, 0.0042870628718965848, 0.0026225129980945289, -0.0051868398870841791, -0.018942064348556418, 0.0010662099005272648, 0.084248692510286396, -0.14404705142730517, -0.062406638005209361, -0.038945252194847894, -0.011492076174215448, -0.0037121225094956731, -0.038589741212373858, -0.0037532140476528608, -0.036017969295867792, 0.0028891237612411538, -0.036108195133255215, -0.12211968978802337, 0.025173988666265409, -0.025359179071178562, 0.0068989136692327504, -0.0082216908587079453, 0.0014255638765257538, 0.0040448479765383362, 0.013407925039911181, 0.002002451017238283, -0.0037915783421507022, -0.0032067140821301215, -0.018820321737602463, 0.11969266232086452, -0.018395712336977493, -0.037809043236401225, 0.004904835744090571, 0.0034801019361780541, -0.0011568383265774347, 0.0082020755347048391, 0.010709470334052113, 0.019674325885585615, 0.011997769372432141, -0.008349026355072519, 0.012179042051196982, 0.02300389673307663, 0.0098472756848154083, 0.0064302927831115476, -0.14744605288292351, 0.026534204406886534, -0.063272121406052137, 0.049141083400019797, -0.0035012311516309379, 0.084643121497808657, -0.0066281908792960127, -0.0077585846054791302, -0.024070717900084526, -0.041298410546568298, 0.0027681917988339483, 0.0035571856232111225, -0.11098095812992081, -0.078500452099071583, 0.018391007411941857, 0.013773989741730778, -0.0021371143459732612, -0.0011321735999915267, -0.0072430692985785902, -0.010309401719903407, 0.062990719186414842, -0.01502224986744622, 0.0092093884949565573, -0.001238715043916, -0.0030545545630278775, -0.0058077640225922258, -0.0017770457988024145, 0.0038041899304654017, -0.010676353238772411, -0.018327041741175384, -0.002166269879402587, -0.013845621915476105, 0.012457480837052014, 0.01353771456133545, -0.00054685397955184548, -0.0078880177668061852, -0.0094247152865019126, 0.013352420806142204, 0.068579281706323159, -0.12143539698835523, -0.081782325545028539, -0.065980683482279479, -0.010546601860983117, -0.0043783600008127773, -0.05486608159345803, 0.0073921059583604322, -0.019690080619172847, 0.0099082722919488359, -0.040905857302904747, -0.14377741722736972, 0.011396642581809936, -0.0067986393405143645, 0.01390262628218563, -0.0034934617623283517, 0.0011952941376991277, -0.00077803989212834929, 0.016175105226449205, 0.0067578262296945114, 0.0041291659096135119, 0.0035971221326567128, 0.01449809823573354, -0.0074006984065132942, -0.0089230267927793289, 0.011716887930877442, -0.027756751855202013, 0.014720074653522104, -0.021888542439394188, 0.0059612931921778963, -0.016064076694588841, 0.011719860714746101, -0.014209706613016911, 0.0092567709024222958, -0.018406378607440869, -0.0049766427601992532, -0.029081121238087128, 0.0071742946708303586, 0.0089682194199777448, -0.00024176942243978917, -0.055461357778055116, 0.014815433805422971, 0.016629369975789884, 0.023107369247796914, -0.020233959404716863, 0.013783844469804908, -0.029631779342020752, 0.012060452395598758, -0.024905994380634858, 0.00049606648921464241, -0.020475221865845137, -0.01373517561205571, 0.011919104456294887, -0.010010923609568078, 0.017159215949685315, 0.00076876809027163562, 0.011311124647243296, -0.0059532299709612411, 0.032657883674858112, -0.011031643300343109, -0.015653314169960922, 0.012922960273595912, -0.023736790568247082, 0.024973222571427676, -0.0025514472129375184, 0.022555208558356663, -0.0095892849911335624, 0.025900091685791663, -0.00038868828941033992, 0.017374298022351752, -0.00073355381543151426, 0.026594432210345714, -0.02360104294200108, 0.021417849546209809, -0.0038452429683915271, 0.025600141563403143, -0.00078091823793893778, 0.01009646934540002, -0.021250983154132649, -0.053682651866637204, -0.010913552123937815, 0.016649565317118704, -0.014769674166023284, 0.020934780653236843, 0.0037547866887495331, 0.030894504483822426, -0.002654650351541615, -0.03879634033463801, 0.017731633623186645, 0.020339404982691985, -0.0047198730235969572, 0.032106706349758145, -0.014484033289708965, 0.014951432946366144, -0.0019747414256714485, 0.024338086319649514, 0.02301530228703208, 0.0045334221408901299]
,
[-0.036087181781653807, 0.24053966500517882, 0.20911655783248922, 0.23366769532547563, 0.023326742830019054, -0.2418369195135377, -0.21922725585447042, -0.073190748591857716, -0.18255386411849323, -0.21870690976304022, -0.51352149149588666, 0.0078798739007787458, -0.038033075696740311, 0.03220225106172505, 0.46795209843072544, 0.00094723505812109208, 0.02631086367183235, -0.4564817704880027, -0.4070291528450386, 0.0047951020537494882]
])

    force.set_values_of_biased_nodes([
        [0.0038832792243293198, 0.031016435036159973, 0.015489190953172052, 0.02788091350137397, -0.0017249471182401673, -0.017713592810006309, -0.030219486265107329, 0.0012253576185186285, 0.0065090342440815123, -0.020770494759002268]
,
[0.28217694893033918, -0.037051908813224045]
        ])

    system.addForce(force)
# end add custom force

integrator = LangevinIntegrator(temperature*kelvin, 1/picosecond, time_step*picoseconds)

if flag_random_seed:
    integrator.setRandomNumberSeed(1)  # set random seed

simulation = Simulation(modeller.topology, system, integrator, platform)
simulation.context.setPositions(modeller.positions)


print('begin Minimizing energy...')
simulation.minimizeEnergy()
print('Done minimizing energy.')

simulation.reporters.append(PDBReporter(pdb_reporter_file, record_interval))
simulation.reporters.append(StateDataReporter(state_data_reporter_file, record_interval, \
								step=True, potentialEnergy=True, temperature=True))
simulation.step(total_number_of_steps)

print('Done!')
